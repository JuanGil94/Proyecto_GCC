
Runner.buttonEvents["New_Button4"]=function(pageObj,proxy,pageid){pageObj.buttonNames[pageObj.buttonNames.length]='New_Button4';if(!pageObj.buttonEventBefore['New_Button4']){pageObj.buttonEventBefore['New_Button4']=function(params,ctrl,pageObj,proxy,pageid,rowData,row,submit){var ajax=ctrl;params["radicado"]=row.getFieldValue("Radicado");params["oficioId"]=row.getFieldValue("OficioId");params["procesoId"]=row.getFieldValue("ProcesoId");}}
if(!pageObj.buttonEventAfter['New_Button4']){pageObj.buttonEventAfter['New_Button4']=function(result,ctrl,pageObj,proxy,pageid,rowData,row,params){var ajax=ctrl;if(result["resultado"]){var printWindow=window.open('','_blank','width=800,height=600');printWindow.document.write('<html>'+'<head>'+'<title>Vista Previa de Impresión</title>'+'<style>'+'@media print {'+'  @page { size: A4; margin: 1cm; }'+'  body { margin: 0; font-family: Arial, sans-serif; }'+'  .content { page-break-inside: avoid; }'+'}'+'body { font-family: Arial, sans-serif; position: relative; margin: 1cm; }'+'.container { display: flex; align-items: center; margin-bottom: 20px; }'+'.header img { width: 170px; margin-right: 30px; }'+'h1 { font-size: 24px; margin: 0; }'+'p { font-size: 16px; margin: 10px 0; }'+'.content { padding: 20px; }'+'.footer { text-align: right; position: fixed; bottom: 20px; right: 20px; }'+'.footer img { width: 190px; }'+'</style>'+'</head>'+'<body>'+'<div class="container">'+'<div class="header">'+'<img src="images/OficiosLogo.png" alt="Logo">'+'</div>'+'<h1>Información Generada</h1>'+'</div>'+'<div class="content">'+'<p>'+result["resultado"]+'</p>'+'</div>'+'<div class="footer">'+'<img src="images/imagen.png" alt="Logo">'+'</div>'+'</body>'+'</html>');printWindow.document.close();printWindow.print();printWindow.focus();}
else{var url=result["total"];var url=url.replace(/\n/g,'');var parser=new DOMParser();var xmlDoc=parser.parseFromString(url,'text/xml');var stringContent=xmlDoc.getElementsByTagName('string')[0].textContent;console.log('URL extraída:',stringContent);if(stringContent.startsWith("https")){var iframe=document.createElement("iframe");iframe.src=stringContent;iframe.width="100%";iframe.height="100%";var ventanaEmergente=window.open("","VentanaEmergente","width=640, height=480");ventanaEmergente.document.body.appendChild(iframe);console.log("La URL comienza con https.");}else{swal("Warning","No se ha firmado el Oficio en Sigobius","warning");console.log("La URL no comienza con https.");}}}}
$('a[id="New_Button4"]').each(function(){if($(this).closest('.gridRowAdd').length){return;}
this.id="New_Button4"+"_"+Runner.genId();var button_New_Button4=new Runner.form.Button({id:this.id,btnName:"New_Button4"});button_New_Button4.init({args:[pageObj,proxy,pageid]});});};