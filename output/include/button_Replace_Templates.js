
Runner.buttonEvents["Replace_Templates"]=function(pageObj,proxy,pageid){pageObj.buttonNames[pageObj.buttonNames.length]='Replace_Templates';if(!pageObj.buttonEventBefore['Replace_Templates']){pageObj.buttonEventBefore['Replace_Templates']=function(params,ctrl,pageObj,proxy,pageid,rowData,row,submit){var ajax=ctrl;}}
if(!pageObj.buttonEventAfter['Replace_Templates']){pageObj.buttonEventAfter['Replace_Templates']=function(result,ctrl,pageObj,proxy,pageid,rowData,row,params){var ajax=ctrl;params["Oficio"]=result['Oficio'];params["OficioId"]=result['OficioId'];var fileInput=document.createElement("input");fileInput.type="file";fileInput.style.display="none";document.body.appendChild(fileInput);fileInput.onchange=function(){if(fileInput.files.length>0){var file=fileInput.files[0];var allowedExtensions=['doc','docx'];var fileExtension=file.name.split('.').pop().toLowerCase();if(!allowedExtensions.includes(fileExtension)){alert("Solo se permiten archivos Word (.doc, .docx).");return;}
var formData=new FormData();formData.append("uploadedFile",file);formData.append("OficioId",params["OficioId"]);$.ajax({url:"uploadTemplate.php",type:"POST",data:formData,processData:false,contentType:false,success:function(response){alert("Archivo subido con Ã©xito: "+response);},error:function(xhr,status,error){alert("Error al subir el archivo: "+error);}});}};fileInput.click();}}
$('a[id="Replace_Templates"]').each(function(){if($(this).closest('.gridRowAdd').length){return;}
this.id="Replace_Templates"+"_"+Runner.genId();var button_Replace_Templates=new Runner.form.Button({id:this.id,btnName:"Replace_Templates"});button_Replace_Templates.init({args:[pageObj,proxy,pageid]});});};